webpackJsonp([16],{"/Jwq":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("BnGv"),i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"Completion mainCont"},[s("Header",{attrs:{title:"填空题库"}}),t._v(" "),s("div",{staticStyle:{width:"50px",height:"50px",position:"relative","margin-top":"-50px"},on:{click:t.goBackInfo}}),t._v(" "),s("div",{staticClass:"headBox"},[s("h3",[s("span",{staticClass:"addTi",on:{click:t.openAddInfo}},[t._v("+")]),t._v("每道填空题分数为"),s("input",{directives:[{name:"model",rawName:"v-model",value:t.scores,expression:"scores"}],staticStyle:{"border-bottom":"1px dotted #555"},attrs:{disabled:""},domProps:{value:t.scores},on:{keyup:[t.scoreFun,t.keyUpFun],input:function(e){e.target.composing||(t.scores=e.target.value)}}}),t._v("分")])]),t._v(" "),s("div",{staticClass:"headBox"},[s("div",{staticClass:"head-title",staticStyle:{display:"inline"}},[t._v("科目：")]),t._v(" "),s("div",{staticClass:"block",staticStyle:{width:"79%","margin-left":"1%",display:"inline"}},t._l(t.SubjectsList,function(e,a){return s("el-radio-group",{key:a,staticStyle:{"margin-right":"8px",overflow:"hidden",display:"inline-block"},model:{value:t.subjradio1,callback:function(e){t.subjradio1=e},expression:"subjradio1"}},[s("el-radio",{attrs:{label:e._id}},[t._v(t._s(e.subjectName))])],1)})),t._v(" "),s("div",{staticStyle:{display:"inline"}},[s("el-button",{attrs:{type:"primary"},on:{click:t.submitSubjesc}},[t._v("查询")])],1)]),t._v(" "),s("div",{staticClass:"group-div"},[s("el-input",{staticClass:"input-with-select",attrs:{placeholder:"题目关键字","prefix-icon":"el-icon-search"},model:{value:t.filterInput,callback:function(e){t.filterInput=e},expression:"filterInput"}},[s("el-button",{attrs:{slot:"append"},on:{click:t.onsearchHandle},slot:"append"},[t._v("搜索")])],1)],1),t._v(" "),s("div",{staticClass:"selectBox"},[s("div",{staticClass:"contentBox"},[s("h3",[s("el-checkbox",{on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选("+t._s(t.checkVal)+"/"+t._s(t.allVal)+")")])],1),t._v(" "),t.tagTotal<=0?s("div",{staticClass:"noInfo"},[t._m(0)]):t._e(),t._v(" "),t._l(t.filterBy(t.resData,t.filterInput),function(e,a){return s("div",{key:a,staticClass:"timuBox"},[s("div",{staticClass:"timu"},[s("el-checkbox-group",{on:{change:t.handleCheckedSingleChange},model:{value:e.checkedSingles,callback:function(s){t.$set(e,"checkedSingles",s)},expression:"item.checkedSingles"}},[s("h4",[s("el-checkbox",{staticStyle:{display:"inline-block"},attrs:{checked:e.checkedSingles}},[t._v(t._s(a+1)+"、"+t._s(e.questDesc))]),t._v(" "),s("span",{staticStyle:{float:"right"},on:{click:function(e){t.deleAnswers(a)}}},[s("img",{attrs:{src:"static/images/dele.png"}})]),t._v(" "),s("span",{staticStyle:{float:"right",color:"#bbb","margin-right":"1%"}},[t._v(t._s(t.scores)+"分")])],1)]),t._v(" "),s("ul",t._l(e.itemList,function(e,a){return s("li",{key:a},[t._v(" （"+t._s(a+1)+"） "),s("span",[t._v(t._s(e.answersl))])])}))],1)])})],2)]),t._v(" "),s("div",{staticClass:"selectBox subBox"},[s("el-row",[s("el-button",{attrs:{type:"primary"},on:{click:t.submitInfo}},[t._v("提交")])],1)],1),t._v(" "),s("el-dialog",{attrs:{title:"新增填空题",visible:t.showAdd},on:{"update:visible":function(e){t.showAdd=e},close:t.resetForm}},[s("el-form",{attrs:{model:t.form}},[s("div",{staticClass:"head-div"},[s("div",{staticClass:"head-title"},[t._v("科目")]),t._v(" "),s("div",{staticClass:"block",staticStyle:{width:"79%","margin-left":"1%"}},t._l(t.SubjectsList,function(e,a){return s("el-radio-group",{key:a,staticStyle:{"margin-right":"8px",overflow:"hidden",display:"inline-block"},model:{value:t.subjradio,callback:function(e){t.subjradio=e},expression:"subjradio"}},[s("el-radio",{attrs:{label:e._id}},[t._v(t._s(e.subjectName))])],1)}))]),t._v(" "),s("span",{staticStyle:{"font-size":"14px"}},[t._v("每题分数："),s("b",{staticStyle:{color:"red"}},[t._v(t._s(t.scores))]),t._v("分")]),t._v(" "),s("el-form-item",{attrs:{label:"题目描述"}},[s("el-input",{attrs:{maxlength:"500",type:"textarea",id:"txt1",autosize:{minRows:2,maxRows:4},placeholder:"请输入题目描述，最多36个字"},on:{change:t.changeValue,blur:t.getTxt1CursorPosition},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),s("div",[s("p",{staticStyle:{"font-size":"18px"}},[s("span",{staticStyle:{color:"#3DA2FE",float:"right"},on:{click:function(e){t.addAnswers()}}},[t._v("插入填空")]),t._v(" "),s("span",[t._v("正确答案")])]),t._v(" "),t._l(t.form.resData,function(e,a){return s("div",{key:a,staticClass:"contBoxMain"},[s("span",[t._v("（"+t._s(a+1)+"）")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"items.content"}],attrs:{placeholder:"输入答案"},domProps:{value:e.content},on:{input:function(s){s.target.composing||t.$set(e,"content",s.target.value)}}}),t._v(" "),s("i",{staticClass:"el-dialog__close el-icon el-icon-close closeBtn",on:{click:function(e){t.closeAnswers(a)}}})])})],2)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticStyle:{display:"inline",width:"45%"},attrs:{type:"primary"},on:{click:t.AddInfo}},[t._v("确 定")]),t._v(" "),s("el-button",{staticStyle:{display:"inline",width:"45%"},on:{click:t.resetForm}},[t._v("取 消")])],1)],1),t._v(" "),s("el-dialog",{attrs:{visible:t.dialogTableVisible,center:"","show-close":!1},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[s("div",{staticClass:"success-dialog"},[s("div",{staticClass:"content"},[s("img",{attrs:{src:"static/images/success.png"}}),t._v(" "),s("div",{staticClass:"name"},[t._v(" 新增填空题成功")]),t._v(" "),t.sendMsgDisabled?s("div",{staticClass:"time"},[t._v(t._s(t.time+"s回到详情页")+">")]):t._e()]),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticStyle:{display:"inline",width:"45%"},attrs:{type:"primary"},on:{click:t.openAddInfo}},[t._v("再加一个")]),t._v(" "),s("el-button",{staticStyle:{display:"inline",width:"45%"},on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("知道了")])],1)])]),t._v(" "),s("div",{staticClass:"scoreAll"},[s("p",[s("span",{staticClass:"big"},[t._v(t._s(t.checkScore))]),t._v("\n\t\t\t\t/"),s("span",[t._v("100 ")])]),t._v(" "),s("p",[t._v("试卷分值")])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"default"},[e("img",{attrs:{src:"static/img/not-add-default.png",alt:""}}),this._v(" "),e("div",{staticClass:"not-class"},[this._v("\n\t\t\t\t\t\t\t暂无相关信息\n\t\t\t\t\t\t")])])}]};var n=function(t){s("8Isp")},r=s("VU/8")(a.a,i,!1,n,null,null);e.default=r.exports},"8Isp":function(t,e){},BnGv:function(t,e,s){"use strict";(function(t){var a=s("fZjL"),i=s.n(a),n=s("Xxa5"),r=s.n(n),o=s("exGp"),c=s.n(o);e.a={name:"Completion",props:{objCom:{type:Object}},data:function(){return{numVal:0,filterInput:"",allVal:"",questKind:"2",subjradio:"",subjradio1:"",SubjectsList:[],scores:3,checkScore:0,allScores:0,editBtn:0,tagTotal:"",dataVal:"",checkVal:0,checkAll:!0,isIndeterminate:!0,showAdd:!1,dialogTableVisible:!1,time:3,sendMsgDisabled:!1,form:{name:"",resData:[]},itemList:[],questList:[],ansList:[],resData:[{qcDesc:"2汽车空调的运行原理以及空调结构解析是什么？",arr:[{name:"A.1压缩机"},{name:"B.冷凝器"},{name:"C.车门"},{name:"D.底盘"}],checkedSingles:!0}]}},methods:{goBackInfo:function(){var t={showPaperShow:!0,addPaperShow:!1};this.$emit("goBackInfo",t)},resetForm:function(){this.form={name:"",resData:[]},this.showAdd=!1},changeValue:function(){console.log(1)},openAddInfo:function(){this.editBtn=-1,this.showAdd=!0},filterBy:function(t,e){return 0===e.length?(this.tagTotal=t.length,this.resData):(t=t.filter(function(t){if(t.questDesc.match(e))return t.questDesc.match(e)}),this.tagTotal=t.length,t)},AddInfo:function(){var t=this;return c()(r.a.mark(function e(){var s,a,i,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s={subjectId:t.subjradio,questKind:t.questKind,questDesc:"",questAnswer:"",itemList:[]},a=void 0,i=void 0,i=t.form.resData,!(t.form.name.length<5||t.form.name.length>500)){e.next=7;break}return t.dialog("题目描述字数不能少于5个且不能多于500个！"),e.abrupt("return",!1);case 7:if(s.questDesc=t.form.name,i.forEach(function(t,e){if(""==t.content)a=1;else{var i={};i.item=e+",",s.itemList.push(i),s.questAnswer+=t.content+"ψ"}}),1!=a){e.next=12;break}return t.dialog("选项内容必填哦"),e.abrupt("return",!1);case 12:if(s.questAnswer=s.questAnswer.substring(0,s.questAnswer.length-1),-1==t.editBtn){e.next=18;break}t.resData.splice(t.editBtn,1,s),console.log(t.resData[t.editBtn]),e.next=23;break;case 18:return e.next=20,t.$axioss.addQuestionItem(s);case 20:n=e.sent,t.resetForm(),1e3==n.data.code?(t.showAdd=!1,t.dialogTableVisible=!0,t.handleCheckedSingleChange(),t.getList()):t.dialog("操作失败");case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}},e,t)}))()},editAnswers:function(t){this.showAdd=!0,this.form.name=this.resData[t].name;var e=[];this.resData[t].arr.forEach(function(t,s){var a={};a.content=t.name,e.push(a)}),this.form.resData=e,this.editBtn=t},getTxt1CursorPosition:function(){var t=document.getElementById("txt1"),e=-1;if(t.selectionStart)e=t.selectionStart;else if(t.value.length>0){var s=document.selection.createRange();s.moveStart("character",-this.form.name.length),e=s.text.length}return sessionStorage.setItem("cursurPosition",e)},addAnswers:function(){var t={title:"",content:"",answers:!1},e=sessionStorage.getItem("cursurPosition");if(!(this.form.resData.length<6))return this.dialog("不能再添加了！"),!1;t.id=this.form.resData.length-0,this.form.resData.push(t),"-1"===e?this.form.name+="("+(t.id+1)+")":e<this.form.name.length?this.form.name=this.form.name.slice(0,e)+"("+(t.id+1)+")"+this.form.name.slice(e):this.form.name=this.form.name.slice(0,e)+"("+(t.id+1)+")"},addAnswersSort:function(){for(var t=0,e=0,s=this.form.name.length;e<s;e++)this.form.name[e].match(/\d/)&&this.form.name[e]==Number(this.form.name.charAt(e))&&(t+=1,this.$set(this.form,"name",this.form.name.replace("("+this.form.name.lastIndexOf(this.form.name.charAt(e))+")","("+t+")")))},deleAnswers:function(t){this.checkVal;this.resData.length,this.resData.splice(t,1),this.handleCheckedSingleChange()},closeAnswers:function(t){var e=0;this.form.name=this.form.name.replace("("+(t+1)+")","");for(var s=0,a=this.form.name.length;s<a;s++)this.form.name[s].match(/\d/)&&t<this.form.name.charAt(s)&&(this.form.name=this.form.name.replace("("+(t+2+e)+")","("+(t+1+e)+")"),e+=1);this.form.resData.splice(t,1)},onsearchHandle:function(){},handleCheckAllChange:function(t){this.checkAll?this.resData.forEach(function(t,e){t.checkedSingles=!0}):this.resData.forEach(function(t,e){t.checkedSingles=!1}),this.scoreFun()},handleCheckedSingleChange:function(t){this.scoreFun()},keyUpFun:function(){},scoreFun:function(){var t=0,e=0,s=0,a=!0,i=Number(this.scores);this.allVal=this.resData.length,this.resData.forEach(function(n,r){return t+=n.score,!0===n.checkedSingles?(e+=i,s++):a=!1,s}),t=this.allVal*this.scores,this.checkAll=!!a,this.checkVal=s,this.allScores=t,this.checkScore=e},getList:function(t){var e=this;return c()(r.a.mark(function s(){var a,n,o;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a={questKind:e.questKind},[],n=[],a.subject=t||e.subjradio1.toString(),s.next=4,e.$axioss.getQuestionItemList(a);case 4:if(1100!==(o=s.sent).code){s.next=10;break}return e.dialog(o.message),s.abrupt("return",!1);case 10:if(1e3!==o.data.code){s.next=21;break}if(0!=i()(o.data.newArr.data).length){s.next=14;break}return e.resData=[],s.abrupt("return",!1);case 14:return e.resData=o.data.newArr.data,e.resData.forEach(function(t,e){n=t.questAnswer.split("ψ"),t.itemList.forEach(function(t,e){t.answersl=n[e]})}),console.log(e.resData),s.abrupt("return",!1);case 21:case"end":return s.stop()}},s,e)}))()},submitInfo:function(){var t=this.resData,e=[],s={};s.tit=this.questKind,t.forEach(function(t,s){!0===t.checkedSingles&&e.push(t)}),s.score=this.checkScore,s.resData=e,this.$emit("getPaperInfo",s)},getSubjectMenuList:function(){var t=this;return c()(r.a.mark(function e(){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axioss.getSubjectMenuList();case 2:if(1e3!=(s=e.sent).data.code){e.next=8;break}return t.SubjectsList=s.data.data,t.subjradio1=s.data.data[0]._id,t.subjradio=s.data.data[0]._id,e.abrupt("return",t.subjradio1);case 8:case"end":return e.stop()}},e,t)}))()},submitSubjesc:function(){var t=this;return c()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.getList(t.subjradio1),e.abrupt("return",!1);case 2:case"end":return e.stop()}},e,t)}))()}},mounted:function(){t("footer").hide();var e=this;this.getSubjectMenuList().then(function(t){""===t&&null===t||e.getList(t)})},computed:{name:function(){return this.form.arr.push(this.form.name)}},watch:{dialogTableVisible:function(t){if(t){var e=this;e.sendMsgDisabled=!0;var s=window.setInterval(function(){e.time--<=1&&(e.time=3,e.sendMsgDisabled=!1,e.dialogTableVisible=!1,window.clearInterval(s))},1e3)}}}}}).call(e,s("7t+N"))}});